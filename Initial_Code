import cv2
import os

# Full path to your image
image_path = r'C:\GitHub\CIM-Summer-Project-Pedestrian-Detection-Using-Haar-Cascades\Input_Data\roadcross.png'

# Check if image exists
if not os.path.exists(image_path):
    print("Error: Image not found at the specified path.")
    exit()

# Load the image
image = cv2.imread(image_path)

# Resize using OpenCV
original_height, original_width = image.shape[:2]
new_width = min(600, original_width)
scale = new_width / original_width
new_height = int(original_height * scale)
image = cv2.resize(image, (new_width, new_height))

# Initialize the HOG descriptor/person detector
hog = cv2.HOGDescriptor()
hog.setSVMDetector(cv2.HOGDescriptor_getDefaultPeopleDetector())

# Detect people in the image
(regions, _) = hog.detectMultiScale(image,
                                    winStride=(4, 4),
                                    padding=(4, 4),
                                    scale=1.05)

# Draw rectangles and labels
for i, (x, y, w, h) in enumerate(regions, start=1):
    cv2.rectangle(image, (x, y), (x + w, y + h), (0, 255, 0), 2)
    label = f"Person {i}"
    cv2.putText(image, label, (x, y - 10),
                cv2.FONT_HERSHEY_SIMPLEX, 0.6, (0, 255, 0), 2)

# Display the result
cv2.imshow("Pedestrian Detection", image)
cv2.waitKey(0)
cv2.destroyAllWindows()
